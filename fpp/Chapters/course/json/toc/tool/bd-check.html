<!doctype html>
<html ng-app="bd">
<head>
  <title>Check BookDefinition</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.5/angular.min.js"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

  <link rel="stylesheet" href="./app/css/style.css">
  <script src="./app/js/app.js"></script>
  <script src="./app/js/rest-service.js"></script>
  <script src="./app/js/fpp-data-service.js"></script>
  <script src="./app/js/book-definition-service.js"></script>
  <script src="./app/js/book-definition-diagnostic-controller.js"></script>
  <script src="./app/js/helpers.js"></script>
</head>
<body>
<div class="container" ng-controller="BookDefinition">
<h2>BookDefinition.json Diagnostic</h2>

<h2>FPP Courses</h2>
<table class="table">
  <thead>
    <tr>
      <th>Course ID</th>
      <th>Course Name</th>
      <th>Book ID</th>
      <th>Book</th>
    </tr>
  </thead>
  <tbody ng-repeat="course in courses track by $index">
    <tr>
      <td>{{course.id}}</td>
      <td>{{course.name}}</td>
      <td>{{course.book_id}}</td>
      <td>{{course.book}}</td>
    </tr>
  </tbody>
</table>

<h3>Labs</h3>
<table class="table">
  <thead>
    <tr>
      <th>Title</th>
      <th>Assignment ID</th>
      <th>from BookDefinition</th>
      <th>Sync ID</th>
      <th>from BookDefinition</th>
    </tr>
  </thead>
  <tbody ng-repeat="lab in labs track by $index">
    <tr ng-class="{'lab-correct': labCorrect(lab), 'lab-err': !labCorrect(lab)}">
      <td>{{lab.name}}</td>
      <td>{{lab.id}}</td>
      <td>{{lab.bdId}}</td>
      <td>{{lab.syncId}}</td>
      <td>{{lab.bdSyncId}}</td>
    </tr>
  </tbody>
</table>

<div ng-repeat="course in courses track by $index">
<h3>Quickchecks</h3>
<table class="table">
  <thead>
    <tr>
      <th>Course ID</th>
      <th>Book</th>
      <th>Chapter</th>
      <th>QC Sync ID</th>
      <th>Problem Instance IDs</th>
    </tr>
  </thead>
  <tbody ng-repeat="chapter in chapters track by $index">
    <tr ng-class="{'qc-correct': qcCorrect(chapter, course.id), 'qc-err': !qcCorrect(chapter, course.id)}">
      <td>{{course.id}}</td>
      <td>{{chapter.chapterData[course.id].bookId}} {{chapter.chapterData[course.id].book}}</td>
      <td>
        {{chapter.title}}<br>
        <a href="//test-ohw.kineticmath.com/rest/rest.php/quickcheck/{{chapter.chapterData[course.id].assignId}}" target="_blank">{{chapter.chapterData[course.id].assignId}}</a>
      </td>
      <td>{{chapter.chapterData[course.id].syncId}}</td>
      <td>
        FPP: {{chapter.chapterData[course.id].probInstIds.join(', ')}}<br>
        BookDefinition: {{chapter.chapterData[course.id].bookDefProbInstIds.join(', ')}}<br>
        <span ng-if="chapter.chapterData[course.id].unknownProbInstIds.length > 0">Unknown BookDefinition IDs: <span style="color:red">{{chapter.chapterData[course.id].unknownProbInstIds.join(', ')}}</span></span>
      </td>
    </tr>

  </tbody>
</table>
</div>

</div>

</body>
</html>
